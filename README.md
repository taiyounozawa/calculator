# C++ Calculator

## 概要

これはC++で実装された、コマンドラインで動作するシンプルな四則演算電卓です。ユーザーは2つの数値と1つの演算子（+, -, \*, /）を入力することで、計算結果を得ることができます。

このプロジェクトは、クラスを使用した基本的なオブジェクト指向プログラミング、入力値の検証、エラーハンドリングといったC++の基本的な要素に加え、`map`やラムダ式といったモダンな機能の学習を目的として作成されました。

## 機能

* **四則演算**:
    * 足し算 (`+`)
    * 引き算 (`-`)
    * 掛け算 (`*`)
    * 割り算 (`/`)
* **エラーハンドリング**:
    * 0での割り算が実行されようとした場合、エラーメッセージを表示してプログラムを安全に終了します。
    * 数値入力が求められる場面で数値以外の文字列が入力された場合、エラーを検知し再入力を促します。
    * 演算子入力が求められる場面で指定外の文字が入力された場合、同様に再入力を促します。

## ファイル構成
```
.
├── .vscode/
│   └── settings.json
├── calc.cpp
├── calc.h
└── main.cpp
```

* **`main.cpp`**: ユーザーからの入力を受け取り、計算を実行して結果を表示するメインロジックが含まれています。
* **`calc.h`**: 計算機能を担う`Calc`クラスの宣言が定義されています。
* **`calc.cpp`**: `Calc`クラスの各メソッド（四則演算、ゲッター、セッター）が実装されています。
* **`.vscode/settings.json`**: C++開発環境のためのVSCodeエディタ設定ファイルです。

## 使い方

1.  **コンパイル**
    お使いのC++コンパイラ（例: g++）で`main.cpp`をコンパイルします。

    ```bash
    g++ main.cpp -o calculator
    ```

2.  **実行**
    生成された実行ファイルを実行します。

    ```bash
    ./calculator
    ```

3.  **入力**
    プログラムの指示に従って、2つの数値と演算子を順番に入力してください。

    **実行例:**
    ```
    Input num (1) : 10
    Input operator (+, -, *, /) : *
    Input num (2) : 2.5
    Result: 25
    ```

## コード解説

### `Calc` クラス (`calc.h`, `calc.cpp`)

計算のコア機能をカプセル化するクラスです。`first_num`と`secound_num`という2つの`double`型の数値を保持し、`Set...`/`Get...`メソッドでアクセスします。四則演算は`CalcSum`, `CalcMin`, `CalcMult`, `CalcDiv`の各メソッドで実行されます。

#### 例外処理 (`try-catch`)

`CalcDiv`メソッド内では、0による除算を防ぐために例外処理が実装されています。 2つ目の数値が0の場合、`std::invalid_argument`例外を`throw`し、`catch`ブロックでエラーメッセージを表示してプログラムを終了させます。

### `main.cpp`

ユーザーとの対話とプログラム全体の流れを制御します。

#### 安全な入力処理 (`getline`, `stringstream`)

ユーザーからの意図しない入力を防ぐため、`DetectNumber`関数内で`getline`と`stringstream`を組み合わせて使用しています。
1.  `getline(cin, line)`で、改行までの一行を安全に文字列として受け取ります。 これにより、入力バッファに余計な文字が残ることを防ぎます。
2.  `stringstream ss(line)`で、その文字列をストリームに変換します。
3.  `ss >> value`で数値への変換を試み、`ss.eof()`で文字列の終端まで全てが数値として解釈できたかを確認します。 これにより、「12abc」のような不正な入力を弾くことができます。

#### `std::map`とラムダ式による処理の分岐

`if-else`や`switch`文を避け、より柔軟な構造にするため、`std::map`とラムダ式で演算子の処理を分岐させています。

```cpp
// 演算子（文字列）と、それに対応する処理（ラムダ式）をペアで格納
map<string, function<double()>> op_map = {
    {"+", [&](){ return calc.CalcSum(); }},
    {"-", [&](){ return calc.CalcMin(); }},
    {"*", [&](){ return calc.CalcMult(); }},
    {"/", [&](){ return calc.CalcDiv(); }}
};

// op（ユーザー入力）をキーとして、対応するラムダ式を呼び出す
cout << "Result: " << op_map[op]() << endl;
```

* `std::map`: 文字列（演算子）をキーとして、対応する関数オブジェクトを値として保持します。
* **ラムダ式**: `[&](){ ... }`の部分です。その場で小さな関数（無名関数）を定義する機能で、ここでは`Calc`クラスの各計算メソッドを呼び出す処理を記述しています。
  
## このプロジェクトでの学習ポイント
この電卓プログラムの開発を通じて、以下の技術や概念について学びました。

* **C++の基本**:
   * `iostream`ライブラリを用いた標準入出力 (`cout`, `cin`)
   * ヘッダファイル (`.h`) とソースファイル (`.cpp`) への分割によるコードの構造化
   * `getline`と`stringstream`を用いた、より安全で堅牢な入力処理
   * `std::map`コンテナによるキーと値のペア管理
   * ラムダ式を用いたインラインでの関数オブジェクト定義
   * `try-catch`ブロックによる例外処理の実装

* **開発ツールと環境**:
   * **Git/GitHub**: バージョン管理の基本的な使い方
   * **Visual Studio Code**: C++開発環境の設定（`.vscode/settings.json`）
   * **Notion**: プロジェクト管理やメモとしての簡単な利用
